  {% comment %} 
     This is all in handlebars because of liquid, the objects are being stored in a cookie 
  {% endcomment %}


  {% comment %}

  I Can use one raw tag if i remove all of the liquid from the page
{% endcomment %} 


{% for image in product.images %}
  {% include 'unpack_image_alt_data', raw_alt_text: image.alt %}
  {% if image.alt contains 'back' and image_color == featured_image_color %}
    {% assign has_back_image = true %}
    {{ image }}
    {% assign back_image = image %}
  {% endif %}
{% endfor %}




{% raw %} 
  <div id="style-{{ style_number }}" class="product-grid-item {{#if sold_out}} sold-out {{/if}} {{#if on_sale}} on-sale {{/if}}">

    <div class="header-row">

      <h4>
     
        <a href="{{ url }}">{{ title }}</a> 

      </h4>

    </div>
    <div class="image-row{{#if has_back_image}} has-back-image {{/if}}">

      <a href="{{ url }}">
        {{#if has_back_image}}
          {{ back_image }}
            <img class="back-image" src="{{ back_image }}" alt="{{ back_image_alt }}">
          {{/if}}
          <img class="featured-image" src="{{ featured_image }}" alt="{{ featured_image_alt }}">
      </a>

    </div>
    
    <div class="meta-row">
      <div class="info-block">
      
        {{#if on_sale}} 
          <div class="sale-price">
            Now: {{price_in_dollars}}
          </div>
          <div class="compare-at-price">
            MRSP: <span>{{compare_in_dollars}}</span>
          </div>
        {{ else }}
          {{#if has_price}}
            <div>
              US {{price_in_dollars}}
            </div>
          {{/if}}
          {{#if has_style_number}}
            <div>
              Style #: {{style_number}}
            </div>
          {{/if}}
        {{/if}}
      </div>

      <div class="button-block">
        <a class="button" href="{{ url }}">
          <span class="label">
            {{# if on_sale}}
              Sale
            {{ else }}
              View Dress
            {{/if}}


          </span>
          <span class="icon"></span>
        </a>
      </div>
    </div>
  </div>
{% endraw %}
<script>
    var product = timber.pageData.productPage.product;
    product.featured_image_alt = "{{ product.featured_image.alt }}";
    product.style_number = "{{ style_number }}";
    product.back_image = "{{ back_image.src | product_img_url: 'large' | escape }}"
    product.back_image_alt = "{{ back_image.alt | escape }}";
</script>