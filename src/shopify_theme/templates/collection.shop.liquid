{% comment %}

For more information on collection tags:
- http://docs.shopify.com/themes/liquid-variables/collection

TODO: Determine what is causing the issue with the html minification on this
page.

{% endcomment %}

{% assign current_tag = current_tags | first | handle %}

{% assign is_valentine_promo = false %}
{% if current_tag == 'valentines-day-shop' %}
  {% assign is_valentine_promo = true %}
{% endif %}

{% if is_valentine_promo == false %}
  <style>

      {% comment %}These are the namespace keys for each of the slides in the collection metafields{% endcomment %}
      {% assign slide_names = 'slide1 slide2 slide3 slide4 slide5' | split: ' ' %}
      {% comment %}Shortcut for the metafields{% endcomment %}
      {% assign meta = collection.metafields %}
      {% for slide_name in slide_names %}
      {% assign slide = collection.metafields[slide_name] %}
      {% unless slide.empty? %}
      .hero-{{ slide_name }} {
          background-image: url('{{ slide.desktop }}');
      }

      @media screen and (min-width: 481px) and (max-width: 1024px){
          .hero-{{ slide_name }} {
              background-image: url('{{ slide.tablet }}');
          }
      }

      @media screen and (max-width: 480px){
          .hero-{{ slide_name }} {
              background-image: url('{{ slide.mobile }}');
          }
      }
      {% endunless %}{% endfor %}

      {% if collection.metafields.other_images.desktop_hero != blank %}
      {% assign other_images = collection.metafields.other_images %}

      .collection-page-hero,
      .shop-page-hero {
          background-image: url('{{ other_images.desktop_hero }}');
      }

      @media screen and (min-width: 481px) and (max-width: 1024px){
          .collection-page-hero,
          .shop-page-hero {
              background-image: url('{{ other_images.tablet_hero }}');
          }
      }

      @media screen and (max-width: 480px){
          .collection-page-hero,
          .shop-page-hero {
              background-image: url('{{ other_images.mobile_hero }}');
          }
      }
      {% endif %}
      {% if collection.metafields.hero.headingColor != blank %}
      .collection-page-hero h2,
      .shop-page-hero h2 {
          color: {{ collection.metafields.hero.headingColor }};
      }
      {% endif %}

      {% if collection.metafields.hero.hideHeading == 'true' %}
      .collection-page-hero .content,
      .collection-page-hero .content {
          display: none;
      }
      {% endif %}

      {% if collection.metafields.hero.centerBackground == 'true' %}
      .collection-page-hero,
      .shop-page-hero {
          background-position: top center !important;
      }
      {% endif %}
  </style>
{% endif %}

{% comment %}
{% if meta.other_images.desktop_hero != blank or meta.slide1.desktop != blank %}
  <div id="top" class="{% if collection.handle == 'shop' %}shop-page-hero{% else %}collection-page-hero{% endif %}">
    {% if meta.slide1.desktop != blank %}
      <div class="js-hero-carousel collection-hero-carousel">
        {% for slide_name in slide_names %}
          {% unless meta[slide_name].desktop == blank %}
            <div class="hero-slide hero-{{ slide_name }}">

            </div>
          {% endunless %}
        {% endfor %}
      </div>
    {% else %}
      <div class="wrapper">

      </div>
    {% endif %}
  </div>
{% endif %}
{% endcomment %}

{% if is_valentine_promo %}
  <div id="top" class="{% if collection.handle == 'shop' %}shop-page-hero{% else %}collection-page-hero{% endif %} valentines-promo-hero">
    <div class="wrapper">
      <div class="sketch-heart-block">
        <img src="{{ 'sketch-heart.svg' | asset_url }}" alt="Sketch Heart" height="85" width="85"/>
      </div>
      <h2>Dress like a goddess this<br /> Valentine’s Day</h2>
      <hr />
      <p>
        We’ve hand selected some<br class="show-small-medium" /> amazing THEIA looks.
        <br class="show-all" />
        Yours this week for 10% off.
      </p>
      <div class="cta-block">
        use coupon &ldquo;theiavalentine&rdquo;<br /> at checkout
      </div>
    </div>
  </div>
{% endif %}

<div id="top" class="shop-page-hero">
  <div class="shop-hero-carousel">
    {% assign carousel_images = 'shop-carousel-01.jpg shop-carousel-02.jpg shop-carousel-03.jpg shop-carousel-04.jpg shop-carousel-05.jpg shop-carousel-06.jpg shop-carousel-07.jpg shop-carousel-08.jpg shop-carousel-09.jpg shop-carousel-10.jpg shop-carousel-11.jpg shop-carousel-12.jpg shop-carousel-13.jpg shop-carousel-14.jpg shop-carousel-15.jpg shop-carousel-16.jpg' | split: ' ' %}
    {% for image in carousel_images %}
      <img src="{{ image | asset_url }}" />
    {% endfor %}
  </div>
</div>

<div class="product-grid-hero">
  <div class="wrapper">

    {% if is_valentine_promo == false %}
    {% assign all_items_label = 'All Styles' %}
    {% include 'product-grid-filters' %}
    {% endif %}

    <div class="hero-body">
      {% paginate collection.products by 12 %}

      {% comment %}
      Use class grid-uniform to have evenly sized columns clear
      each other properly at each breakpoint.
      {% endcomment %}

      {% comment %}
      Loop through our products in the current collection.
      See the snippet 'product-grid-item' for the layout.
      {% endcomment %}

      <div id="collection-items"
           data-has-next-page="{% if paginate.next %}true{% else %}false{% endif %}"
           {% if paginate.next %}
           data-next-page-url="{{ paginate.next.url }}"
           {% endif %}
           >
        {% for product in collection.products %}

          {% include 'product-grid-item' %}

        {% else %}

          <div class="grid-item">
            <p>Sorry, there are no products matching your search.</p>
          </div>

        {% endfor %}
      </div>

      <div class="loading-image-block js-hidden">
        <img src="{{ 'loading.gif' | asset_url }}" />
      </div>

      {% include 'pagination-block' %}

      <div class="back-to-top-block js-hidden">
        <a data-scroll class="back-to-top-link" href="#top">Back to Top</a>
      </div>

    {% endpaginate %}
    </div>

  </div>
</div>

<hr class="hr-4-col" />

{% include 'social-link-newsletter-hero' %}
